使用文件操作磁盘：
![[Pasted image 20240331142430.png]]
![[Pasted image 20240331143130.png]]
fseek就是读写指针，可以实现文件中**字符流**的偏移，根据fseek的数值，通过inode查找盘块号，进行修改就可以了。
![[Pasted image 20240331143408.png]]
如果追加，pos（fseek）就是文件大小（末尾），如果是指定pos，就从file中找出f_pos位置，file结构体中的这个变量为上次读写的位置。
下面要根据读写位置得到盘块号：直接用pos除block大小。
![[Pasted image 20240331143515.png]]
bread启动磁盘读这个盘块之后，直接放入电梯队列然后睡眠，等DMA完成，并存入内存后，唤醒进程，就得到了该盘块。linux0.11也支持多级inode索引：
![[Pasted image 20240331145227.png]]
inode不仅可以存储文件索引，还存储了文件的mode。