这节主要讲如何从目录解析找到文件的inode。其实就是把open系统调用弄明白。
`open`系统调用的原理：
* 解析路径
* 把inode读进PCB的file数组里
* 把该inode对应的数组下标返回
所以核心就是解析路径，找到inode。
![[Pasted image 20240401212156.png]]
![[Pasted image 20240401212216.png]]
可见会先判断是不是`/`，如果是，就代表从根目录开始，就直接返回PCB里存的根目录FCB，这样可以减少从硬盘指定位置读取FCB的时间。如果不是`/`，那就是从当前目录开始，就从PCB里返回当前目录。
从根目录开始，读入根目录的盘块数组，从中进行字符串匹配，找到要进入的项，然后找到这一项的inode编号，通过inode编号找到这个inode。
### 如何得到根目录的inode？
![[Pasted image 20240401231106.png]]
在0号进程init中，调用了mount_root()，该函数内部获取了ROOT_INO对应第0项，即根目录的inode。然后存入了init进程的PCB中。因为计算机中所有进程都是init的子进程，所以最终可以实现所有进程的PCB中都存在root的inode。
![[Pasted image 20240401232132.png]]

