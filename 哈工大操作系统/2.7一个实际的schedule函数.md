![[Pasted image 20240408232129.png]]
counter既用作优先级判断，又用作时间片。当运行进程的时间片不全为0时，选时间片最大的进程作为next，当运行态进程时间片全为0，把所有进程当前counter/2，然后再加上counter初始值。所以对于运行态且counter为0的进程，相当于给counter赋初值，对于正在睡眠的进程，则会导致睡醒后获得更多的时间片。
![[Pasted image 20240408234425.png]]
在时钟中断里，当前运行中的进程的counter会被修改，当counter为0，schedule就会被调用，导致进程切换。
![[Pasted image 20240408234726.png]]
这样又可以实现动态优先级，当IO操作越长，就导致IO进程的counter不断加长，时间片不断增多。IO结束后运行的机会也大大增加。
这样就提高了IO约束型进程的优先级，即前台进程的优先级越高。
![[Pasted image 20240408235148.png]]
c(n)是个几何级数，收敛于2p，所以一个进程最大时间片就是2p。